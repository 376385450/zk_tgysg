package com.sinohealth.application;

import com.sinohealth.BaseBootTest;
import com.sinohealth.common.utils.JsonUtils;
import com.sinohealth.system.biz.application.util.ApplicationSqlBuilder;
import com.sinohealth.system.domain.TgTemplateInfo;
import com.sinohealth.system.domain.converter.JsonBeanConverter;
import com.sinohealth.system.domain.vo.TgDataRangeGroupVO;
import com.sinohealth.system.service.DataRangeTemplateService;
import lombok.extern.slf4j.Slf4j;
import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ActiveProfiles;

import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.atomic.AtomicReference;

/**
 * @author kuangchengping@sinohealth.cn
 * 2022-11-22 15:00
 */
@Slf4j
@ActiveProfiles("test")
public class SqlBuilderTest extends BaseBootTest {

    @Autowired
    DataRangeTemplateService dataRangeTemplateService;

    //    @Test
    public void testA() throws Exception {


        String dataRange = "{\"filters\": [{\"id\": \"1\", \"filters\": [{\"isFather\": 1, \"filterItem\": {\"id\": \"Kt3X1669086456695\", \"andOr\": \"and\", \"value\": \"P001\", \"fieldId\": 676, \"filters\": [{\"id\": \"GrpN1669086558371\", \"filters\": [{\"isFather\": 1, \"filterItem\": {\"id\": \"ZTTR1669086558371\", \"andOr\": \"or\", \"value\": \"P001\", \"fieldId\": 676, \"filters\": [{\"id\": \"RMw41669086566986\", \"filters\": [{\"filterItem\": {\"id\": \"PKe61669086566986\", \"andOr\": \"and\", \"value\": \"P001\", \"fieldId\": 676, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"filterItem\": {\"id\": \"K38p1669086566986\", \"andOr\": \"and\", \"value\": \"维生素矿物质补充剂\", \"fieldId\": 698, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"filterItem\": {\"id\": \"GSGM1669086597497\", \"andOr\": \"and\", \"value\": \"硒维康口服液\", \"fieldId\": 682, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"filterItem\": {\"id\": \"2CTi1669089014648\", \"andOr\": \"and\", \"value\": \"Rx\", \"fieldId\": 678, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"notEqualTo\"}}], \"fatherId\": \"ZTTR1669086558371\", \"logicalOperator\": \"and\"}], \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"isFather\": 1, \"filterItem\": {\"id\": \"3kX81669086558371\", \"andOr\": \"or\", \"value\": \"P009\", \"fieldId\": 676, \"filters\": [{\"id\": \"mCiQ1669086662773\", \"filters\": [{\"filterItem\": {\"id\": \"5x4r1669086662773\", \"andOr\": \"and\", \"value\": \"P009\", \"fieldId\": 676, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"filterItem\": {\"id\": \"CTGt1669086662773\", \"andOr\": \"and\", \"value\": \"肝胆疾病用药\", \"fieldId\": 698, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"filterItem\": {\"id\": \"t3pf1669086708125\", \"andOr\": \"and\", \"value\": \"苯丙醇软胶囊|三七白及口服液\", \"fieldId\": 682, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"contain\"}}, {\"filterItem\": {\"id\": \"i2fE1669089025719\", \"andOr\": \"and\", \"value\": \"Rx\", \"fieldId\": 678, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"notEqualTo\"}}], \"fatherId\": \"3kX81669086558371\", \"logicalOperator\": \"and\"}], \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"isFather\": 1, \"filterItem\": {\"id\": \"jp5F1669086738043\", \"andOr\": \"or\", \"value\": \"P012\", \"fieldId\": 676, \"filters\": [{\"id\": \"pTe61669086755809\", \"filters\": [{\"filterItem\": {\"id\": \"Hxid1669086755809\", \"andOr\": \"and\", \"value\": \"P012\", \"fieldId\": 676, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"filterItem\": {\"id\": \"TRay1669086755809\", \"andOr\": \"and\", \"value\": \"解热、镇痛、抗炎与抗风湿及抗痛风药\", \"fieldId\": 698, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"filterItem\": {\"id\": \"NyD21669086782282\", \"andOr\": \"and\", \"value\": \"消旋山莨菪碱片(654-2)\", \"fieldId\": 682, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"filterItem\": {\"id\": \"pshS1669089039485\", \"andOr\": \"and\", \"value\": \"Rx\", \"fieldId\": 678, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"notEqualTo\"}}], \"fatherId\": \"jp5F1669086738043\", \"logicalOperator\": \"and\"}], \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"isFather\": 1, \"filterItem\": {\"id\": \"XnFi1669086899623\", \"andOr\": \"or\", \"value\": \"P028\", \"fieldId\": 676, \"filters\": [{\"id\": \"4wpa1669086908641\", \"filters\": [{\"filterItem\": {\"id\": \"MBcS1669086908641\", \"andOr\": \"and\", \"value\": \"P028\", \"fieldId\": 676, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"filterItem\": {\"id\": \"hFet1669086908641\", \"andOr\": \"and\", \"value\": \"滋补保健类\", \"fieldId\": 698, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"filterItem\": {\"id\": \"CHy71669086927039\", \"andOr\": \"and\", \"value\": \"葡萄糖固体饮料|乳糖酶滴剂|乳糖酶水解蛋白调制乳粉|酸性乳糖酶调制乳粉\", \"fieldId\": 682, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"contain\"}}, {\"filterItem\": {\"id\": \"mWF71669089048817\", \"andOr\": \"and\", \"value\": \"Rx\", \"fieldId\": 678, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"notEqualTo\"}}], \"fatherId\": \"XnFi1669086899623\", \"logicalOperator\": \"and\"}], \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"isFather\": 1, \"filterItem\": {\"id\": \"QQbD1669086964378\", \"andOr\": \"or\", \"value\": \"P005\", \"fieldId\": 676, \"filters\": [{\"id\": \"3dC51669086975517\", \"filters\": [{\"filterItem\": {\"id\": \"7Qdf1669086975517\", \"andOr\": \"and\", \"value\": \"P005\", \"fieldId\": 676, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"filterItem\": {\"id\": \"Bh4Q1669086975517\", \"andOr\": \"and\", \"value\": \"胃肠道疾病用药\", \"fieldId\": 698, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"filterItem\": {\"id\": \"A46Q1669086996031\", \"andOr\": \"and\", \"value\": \"清火宝益生元固体饮料|羔羊胃提取物维B12胶囊|盐酸哌仑西平片|铋镁豆蔻片|铋镁碳酸氢钠片|大黄碳酸氢钠片|复方颠茄铋镁片|复方颠茄氢氧化铝片|复方甘铋镁片|复方龙胆碳酸氢钠片|复方芦荟维U片|复方铝酸铋颗粒|复方铝酸铋片|复方木香铝镁片|复方尿囊素片|复方氢氧化铝片|复方维U颠茄铋铝片|复方维生素U胶囊|复方维生素U片|复方胃膜素片|盖胃平片|甘羟铝片|枸橼酸铋钾胶囊|枸橼酸铋钾颗粒|枸橼酸铋钾口服溶液|枸橼酸铋钾片|胶体果胶铋胶囊|胶体酒石酸铋胶囊|硫糖铝分散片|硫糖铝咀嚼片|硫糖铝颗粒|硫糖铝口服混悬液|龙胆碳酸氢钠片|铝镁颠茄片|铝碳酸镁混悬液|铝碳酸镁咀嚼片|铝碳酸镁片|氢氧化铝片|神黄钠铝胶囊|鼠李铋镁片|碳酸钙二甲硅油咀嚼片|碳酸钙甘氨酸胶囊|碳酸氢钠片|维U颠茄铝分散片|维U颠茄铝胶囊|维U颠茄铝胶囊(Ⅱ)|维U颠茄铝镁胶囊|维U颠茄铝镁片|维U颠茄铝镁片(Ⅱ)|金品婴儿清清宝|经典婴儿清清宝|经典幼儿清清宝|优+婴儿清清宝|幼儿清清宝|倍乐舒软胶囊|猴头菇混合片|猴头菇口服液|猴头菇胃肠保健口服液|猴头菇压片糖果|康胃保健口服液|多潘立酮分散片|多潘立酮混悬液|多潘立酮口崩片|多潘立酮片|马来酸多潘立酮片|贝贝开胃宝营养液|促进消化咀嚼片|二甲硅油片|好胃口口服液|开胃消食片|斯唯诺口服液|消食化积口服液|消食片|小儿七星茶固体饮料|优+幼儿清清宝|多酶片|复方胃蛋白酶颗粒|复方消化酶胶囊|复方消化酶胶囊(Ⅱ)|复方胰酶散|胃蛋白酶颗粒|胃蛋白酶口服溶液|胃蛋白酶片|胰酶肠溶胶囊|胰酶肠溶片\", \"fieldId\": 682, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"contain\"}}, {\"filterItem\": {\"id\": \"AmbY1669089059076\", \"andOr\": \"and\", \"value\": \"Rx\", \"fieldId\": 678, \"filters\": null, \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"notEqualTo\"}}], \"fatherId\": \"QQbD1669086964378\", \"logicalOperator\": \"and\"}], \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}], \"fatherId\": \"Kt3X1669086456695\", \"logicalOperator\": \"or\"}], \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}, {\"isFather\": 1, \"filterItem\": {\"id\": \"fRQG1669086525897\", \"andOr\": \"and\", \"value\": \"P001\", \"fieldId\": 676, \"filters\": [{\"id\": \"xHDy1669087357478\", \"filters\": [], \"fatherId\": \"fRQG1669086525897\", \"logicalOperator\": \"and\"}], \"tableId\": 18, \"isItself\": 1, \"uniqueId\": 1, \"fieldName\": null, \"fieldAlias\": null, \"otherValue\": null, \"tableAlias\": null, \"functionalOperator\": \"equalTo\"}}], \"logicalOperator\": \"and\"}], \"logicalOperator\": \"\"}";
        TgTemplateInfo info = new TgTemplateInfo();
        info.setDataRangeJson(dataRange);
        TgTemplateInfo applicationInfo = JsonBeanConverter.convert2Obj(info);

        ApplicationSqlBuilder builder = new ApplicationSqlBuilder();

        AtomicReference<String> groupBy = new AtomicReference<>();
        AtomicReference<String> baseTable = new AtomicReference<>();
        builder.setTemplateInfo(applicationInfo);

        String sql = builder.combineTemplateSql(groupBy, baseTable, false);

        log.info("applicationInfo={}", sql);
    }

    @Test
    public void testB() {

//        String group = "[{\"groupId\":null,\"data\":[{\"id\":\"138ig3kawga800\",\"pid\":\"\",\"categoryId\":290,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"ED\",\"children\":null,\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"Eifm1690852180222\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"pNEH1690852189830\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":113,\"fieldName\":\"sort3\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"早泄|阳痿\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品类\"}]},{\"groupId\":null,\"data\":[{\"id\":\"3hq7rmzu69k000\",\"pid\":\"\",\"categoryId\":291,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"PDE5i\",\"children\":null,\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"TPfb1690857656016\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"46tB1690857661676\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":231,\"fieldName\":\"tym\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"伐地那非|西地那非|他达拉非\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品类\"}]},{\"groupId\":null,\"data\":[{\"id\":\"5trou416coo000\",\"pid\":\"\",\"categoryId\":292,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"西地那非\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"EN881690948248337\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":231,\"fieldName\":\"tym\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"西地那非\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"1q87x3py1e5c00\",\"pid\":\"\",\"categoryId\":292,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"他达拉非\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"PBiG1690948264373\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":231,\"fieldName\":\"tym\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"他达拉非\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"4r7wogg4qyy000\",\"pid\":\"\",\"categoryId\":292,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"伐地那非\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"bkbt1690948277797\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":231,\"fieldName\":\"tym\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"伐地那非\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"bxy0lqyctxs00\",\"pid\":\"\",\"categoryId\":292,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"阿伐那非\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"GmdH1690948289686\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":231,\"fieldName\":\"tym\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"阿伐那非\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"1hu5uewn6dj400\",\"pid\":\"\",\"categoryId\":292,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"爱地那非\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"BB7D1690948301568\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":231,\"fieldName\":\"tym\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"爱地那非\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"}]},{\"groupId\":null,\"data\":[{\"id\":\"dxnv9y40few00\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"万艾可\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"ZnZf1690948346438\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"SkXH1690948352839\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"万艾可(枸橼酸西地那非片)|万艾可(枸橼酸西地那非口崩片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"4cewcivrlcs000\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"金戈\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"PNJa1690948364585\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"3GGn1690948370288\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"金戈(枸橼酸西地那非片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"4a5pqbjddi0000\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"希爱力\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"DJPS1690948381927\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"3RC41690948387087\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"希爱力(他达拉非片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"xkodcjbk5e800\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"蒂欣\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"Dkcb1690948398647\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"SCjj1690948403607\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"蒂欣(他达拉非片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"5ou066g85m8000\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"千威\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"PyXc1690948416007\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"2aQ41690948421088\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"千威(枸橼酸西地那非片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"3ei7t6vjlz0000\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"伟哥\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"7MXn1690948431863\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"psY71690948436888\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"伟哥(他达拉非片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"7jwzvajqyq800\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"杰士邦\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"EtER1690948452968\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"YxeP1690948457952\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"杰士邦(他达拉非片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"}]}]";

//        String group = "[{\"data\":[{\"categoryName\":\"A\",\"categoryId\":99,\"id\":\"n7fymj6kc9c00\",\"pid\":\"\",\"granularity\":\"品类\",\"selectIndex\":1,\"isPopover\":false,\"children\":[{\"id\":\"1pz3pboelbts00\",\"categoryName\":\"a1\",\"categoryId\":100,\"pid\":\"n7fymj6kc9c00\",\"selectIndex\":2,\"granularity\":\"品牌\",\"dataRangeInfo\":{\"filters\":[{\"id\":\"1\",\"filters\":[{\"filterItem\":{\"isItself\":1,\"id\":\"TAyx1691048430565\",\"fieldId\":100,\"andOr\":\"and\",\"uniqueId\":\"1\",\"value\":\"2023-01-01\",\"functionalOperator\":\"equalTo\",\"type\":\"DateTime\",\"timeViewName\":\"2023\",\"timeDimension\":\"year\",\"tableId\":\"\",\"fieldName\":\"test2\"}}],\"logicalOperator\":\"and\",\"show\":false}],\"logicalOperator\":\"\"},\"isPopover\":false}]},{\"id\":\"30ei9rsjoa0000\",\"categoryName\":\"B\",\"categoryId\":99,\"selectIndex\":1,\"granularity\":\"品类\",\"pid\":\"\",\"isPopover\":false,\"children\":[{\"id\":\"5jsudbkbmy8000\",\"categoryName\":\"b1\",\"categoryId\":100,\"pid\":\"30ei9rsjoa0000\",\"selectIndex\":2,\"granularity\":\"品牌\",\"dataRangeInfo\":{\"filters\":[{\"id\":\"1\",\"filters\":[{\"filterItem\":{\"isItself\":1,\"id\":\"eha81691048527279\",\"fieldId\":100,\"andOr\":\"and\",\"uniqueId\":\"1\",\"value\":\"2023-04-01\",\"functionalOperator\":\"equalTo\",\"type\":\"DateTime\",\"timeViewName\":\"2023-Q2\",\"timeDimension\":\"quarter\",\"tableId\":\"\",\"fieldName\":\"test2\"}}],\"logicalOperator\":\"and\",\"show\":false}],\"logicalOperator\":\"\"}}]},{\"id\":\"53dcpeshll0000\",\"categoryName\":\"C\",\"categoryId\":99,\"selectIndex\":1,\"granularity\":\"品类\",\"pid\":\"\",\"children\":[{\"id\":\"2x87u68yjgo000\",\"categoryName\":\"c1\",\"categoryId\":100,\"pid\":\"53dcpeshll0000\",\"selectIndex\":2,\"granularity\":\"品牌\",\"dataRangeInfo\":{\"filters\":[{\"id\":\"1\",\"filters\":[{\"filterItem\":{\"isItself\":1,\"id\":\"eha81691048527279\",\"fieldId\":100,\"andOr\":\"and\",\"uniqueId\":\"1\",\"value\":\"2023-04-01\",\"functionalOperator\":\"equalTo\",\"type\":\"DateTime\",\"timeViewName\":\"2023-Q2\",\"timeDimension\":\"quarter\",\"tableId\":\"\",\"fieldName\":\"test2\"}}],\"logicalOperator\":\"and\",\"show\":false}],\"logicalOperator\":\"\"}}]},{\"id\":\"3vphve6n5y4000\",\"categoryName\":\"D\",\"categoryId\":99,\"selectIndex\":1,\"granularity\":\"品类\",\"pid\":\"\",\"children\":[{\"id\":\"fddj7090a3400\",\"categoryName\":\"d1\",\"categoryId\":100,\"pid\":\"3vphve6n5y4000\",\"selectIndex\":2,\"granularity\":\"品牌\",\"dataRangeInfo\":{\"filters\":[{\"id\":\"1\",\"filters\":[{\"filterItem\":{\"isItself\":1,\"id\":\"tKKX1691048580171\",\"fieldId\":100,\"andOr\":\"and\",\"uniqueId\":\"1\",\"value\":\"2023-08-03\",\"functionalOperator\":\"equalTo\",\"type\":\"DateTime\",\"timeViewName\":\"2023-08-03\",\"timeDimension\":\"date\",\"tableId\":\"\",\"fieldName\":\"test2\"}}],\"logicalOperator\":\"and\",\"show\":false}],\"logicalOperator\":\"\"}}]}]}]";
//        String group ="[{\"data\":[{\"categoryName\":\"A\",\"categoryId\":99,\"id\":\"n7fymj6kc9c00\",\"pid\":\"\",\"granularity\":\"品类\",\"selectIndex\":1,\"isPopover\":false,\"children\":[{\"id\":\"1pz3pboelbts00\",\"categoryName\":\"a1\",\"categoryId\":99,\"pid\":\"n7fymj6kc9c00\",\"selectIndex\":2,\"granularity\":\"品牌\",\"dataRangeInfo\":{\"filters\":[{\"id\":\"1\",\"filters\":[{\"filterItem\":{\"isItself\":1,\"id\":\"TAyx1691048430565\",\"fieldId\":111,\"andOr\":\"and\",\"uniqueId\":\"1\",\"value\":\"中药饮片\",\"functionalOperator\":\"equalTo\",\"type\":\"String\",\"timeViewName\":\"\",\"timeDimension\":\"\",\"tableId\":\"\",\"fieldName\":\"sort1\"}}],\"logicalOperator\":\"and\",\"show\":false}],\"logicalOperator\":\"\"},\"isPopover\":false}]},{\"id\":\"30ei9rsjoa0000\",\"categoryName\":\"B\",\"categoryId\":99,\"selectIndex\":1,\"granularity\":\"品类\",\"pid\":\"\",\"isPopover\":false,\"children\":[{\"id\":\"5jsudbkbmy8000\",\"categoryName\":\"b1\",\"categoryId\":99,\"pid\":\"30ei9rsjoa0000\",\"selectIndex\":2,\"granularity\":\"品牌\",\"dataRangeInfo\":{\"filters\":[{\"id\":\"1\",\"filters\":[{\"filterItem\":{\"isItself\":1,\"id\":\"eha81691048527279\",\"fieldId\":111,\"andOr\":\"and\",\"uniqueId\":\"1\",\"value\":\"中药饮片\",\"functionalOperator\":\"equalTo\",\"type\":\"String\",\"timeViewName\":\"\",\"timeDimension\":\"\",\"tableId\":\"\",\"fieldName\":\"sort1\"}}],\"logicalOperator\":\"and\",\"show\":false}],\"logicalOperator\":\"\"},\"isPopover\":false}]},{\"id\":\"53dcpeshll0000\",\"categoryName\":\"C\",\"categoryId\":99,\"selectIndex\":1,\"granularity\":\"品类\",\"pid\":\"\",\"children\":[{\"id\":\"2x87u68yjgo000\",\"categoryName\":\"c1\",\"categoryId\":99,\"pid\":\"53dcpeshll0000\",\"selectIndex\":2,\"granularity\":\"品牌\",\"dataRangeInfo\":{\"filters\":[{\"id\":\"1\",\"filters\":[{\"filterItem\":{\"isItself\":1,\"id\":\"BpjP1691049641505\",\"fieldId\":111,\"andOr\":\"and\",\"uniqueId\":\"1\",\"value\":\"中药饮片\",\"functionalOperator\":\"equalTo\",\"type\":\"String\",\"timeViewName\":\"\",\"timeDimension\":\"\",\"tableId\":\"\",\"fieldName\":\"sort1\"}}],\"logicalOperator\":\"and\",\"show\":false}],\"logicalOperator\":\"\"}}]},{\"id\":\"3vphve6n5y4000\",\"categoryName\":\"D\",\"categoryId\":99,\"selectIndex\":1,\"granularity\":\"品类\",\"pid\":\"\",\"children\":[{\"id\":\"fddj7090a3400\",\"categoryName\":\"d1\",\"categoryId\":99,\"pid\":\"3vphve6n5y4000\",\"selectIndex\":2,\"granularity\":\"品牌\",\"dataRangeInfo\":{\"filters\":[{\"id\":\"1\",\"filters\":[{\"filterItem\":{\"isItself\":1,\"id\":\"tKKX1691048580171\",\"fieldId\":111,\"andOr\":\"and\",\"uniqueId\":\"1\",\"value\":\"中药饮片\",\"functionalOperator\":\"equalTo\",\"type\":\"String\",\"timeViewName\":\"\",\"timeDimension\":\"\",\"tableId\":\"\",\"fieldName\":\"sort1\"}}],\"logicalOperator\":\"and\",\"show\":false}],\"logicalOperator\":\"\"},\"isPopover\":false}]}]}]";
        String group = "[{\"groupId\":null,\"data\":[{\"id\":\"138ig3kawga800\",\"pid\":\"\",\"categoryId\":290,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"ED\",\"children\":null,\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"Eifm1690852180222\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"pNEH1690852189830\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":113,\"fieldName\":\"sort3\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"早泄|阳痿\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品类\"}]},{\"groupId\":null,\"data\":[{\"id\":\"3hq7rmzu69k000\",\"pid\":\"\",\"categoryId\":291,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"PDE5i\",\"children\":null,\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"TPfb1690857656016\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"46tB1690857661676\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":231,\"fieldName\":\"tym\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"伐地那非|西地那非|他达拉非\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品类\"}]},{\"groupId\":null,\"data\":[{\"id\":\"5trou416coo000\",\"pid\":\"\",\"categoryId\":292,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"西地那非\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"EN881690948248337\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":231,\"fieldName\":\"tym\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"西地那非\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"1q87x3py1e5c00\",\"pid\":\"\",\"categoryId\":292,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"他达拉非\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"PBiG1690948264373\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":231,\"fieldName\":\"tym\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"他达拉非\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"4r7wogg4qyy000\",\"pid\":\"\",\"categoryId\":292,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"伐地那非\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"bkbt1690948277797\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":231,\"fieldName\":\"tym\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"伐地那非\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"bxy0lqyctxs00\",\"pid\":\"\",\"categoryId\":292,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"阿伐那非\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"GmdH1690948289686\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":231,\"fieldName\":\"tym\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"阿伐那非\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"1hu5uewn6dj400\",\"pid\":\"\",\"categoryId\":292,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"爱地那非\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"BB7D1690948301568\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":231,\"fieldName\":\"tym\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"爱地那非\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"}]},{\"groupId\":null,\"data\":[{\"id\":\"dxnv9y40few00\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"万艾可\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"ZnZf1690948346438\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"SkXH1690948352839\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"万艾可(枸橼酸西地那非片)|万艾可(枸橼酸西地那非口崩片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"4cewcivrlcs000\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"金戈\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"PNJa1690948364585\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"3GGn1690948370288\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"金戈(枸橼酸西地那非片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"4a5pqbjddi0000\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"希爱力\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"DJPS1690948381927\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"3RC41690948387087\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"希爱力(他达拉非片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"xkodcjbk5e800\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"蒂欣\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"Dkcb1690948398647\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"SCjj1690948403607\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"蒂欣(他达拉非片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"5ou066g85m8000\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"千威\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"PyXc1690948416007\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"2aQ41690948421088\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"千威(枸橼酸西地那非片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"3ei7t6vjlz0000\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"伟哥\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"7MXn1690948431863\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"psY71690948436888\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"伟哥(他达拉非片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"},{\"id\":\"7jwzvajqyq800\",\"pid\":\"\",\"categoryId\":211,\"selectIndex\":1,\"categoryChineseName\":null,\"categoryEnName\":null,\"categoryName\":\"杰士邦\",\"children\":[],\"dataRangeInfo\":{\"logicalOperator\":\"\",\"filters\":[{\"id\":\"1\",\"logicalOperator\":\"and\",\"filters\":[{\"filterItem\":{\"id\":\"EtER1690948452968\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":160,\"fieldName\":\"prodcode\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"P018\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}},{\"filterItem\":{\"id\":\"YxeP1690948457952\",\"uniqueId\":1,\"tableId\":null,\"tableAlias\":null,\"fieldId\":114,\"fieldName\":\"brand\",\"fieldAlias\":null,\"andOr\":\"and\",\"functionalOperator\":\"equalTo\",\"value\":\"杰士邦(他达拉非片)\",\"otherValue\":null,\"isItself\":1,\"filters\":null,\"timeDimension\":\"\",\"timeViewName\":\"\"}}]}]},\"granularity\":\"品牌\"}]}]";
        List<TgDataRangeGroupVO> groupVOS = JsonUtils.parseArray(group, TgDataRangeGroupVO.class);


        List<String> sqlList;
        sqlList = new ArrayList<>();
        for (TgDataRangeGroupVO groupVO : groupVOS) {
            String sql = dataRangeTemplateService.buildSqlBydDataRangeGroup(groupVO);
            sqlList.add(sql);

        }
        String caseWhen = String.join("", sqlList);
        caseWhen = caseWhen.substring(0, caseWhen.length() - 1);
        caseWhen = caseWhen.replace("t_1.", "");
        System.out.println("测试》》》》》》》" +caseWhen);


//            Map<Long, String> buildSqlMap = dataRangeTemplateService.getBuildSqlMap(ids, "1001");

    }


}
